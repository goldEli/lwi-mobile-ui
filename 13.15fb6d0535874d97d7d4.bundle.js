/*! For license information please see 13.15fb6d0535874d97d7d4.bundle.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1522:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"taro_tabbar",(function(){return Tabbar}));var _index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(225),_index_ff1b322a_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1530);function isAbsolute(pathname){return"/"===pathname.charAt(0)}function spliceOne(list,index){for(var i=index,k=i+1,n=list.length;k<n;i+=1,k+=1)list[i]=list[k];list.pop()}const splitUrl=_url=>{let pos,url=_url||"";const res={path:null,query:null,fragment:null};return pos=url.indexOf("#"),pos>-1&&(res.fragment=url.substring(pos+1),url=url.substring(0,pos)),pos=url.indexOf("?"),pos>-1&&(res.query=url.substring(pos+1),url=url.substring(0,pos)),res.path=url,res},TabbarItem=({index:index,isSelected:isSelected=!1,textColor:textColor,iconPath:iconPath,badgeText:badgeText,showRedDot:showRedDot=!1,text:text,onSelect:onSelect})=>{const className=Object(_index_ff1b322a_js__WEBPACK_IMPORTED_MODULE_1__.a)("weui-tabbar__item",{"weui-bar__item_on":isSelected});return Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("a",{key:index,href:"javascript:;",class:className,onClick:function onClick(){onSelect(index)}},Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("span",{style:{display:"inline-block",position:"relative"}},Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("img",{src:iconPath,alt:"",class:"weui-tabbar__icon"}),!!badgeText&&Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("span",{class:"weui-badge taro-tabbar-badge",style:{position:"absolute",top:"-2px",right:"-13px"}},badgeText),showRedDot&&Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("span",{class:"weui-badge weui-badge_dot",style:{position:"absolute",top:"0",right:"-6px"}})),Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("p",{class:"weui-tabbar__label",style:{color:textColor}},text))},Taro=__webpack_require__(164),addLeadingSlash=str=>"/"===str[0]?str:"/"+str,stripBasename=(path,prefix)=>((path,prefix)=>new RegExp("^"+prefix+"(\\/|\\?|#|$)","i").test(path))(path,prefix)?path.substr(prefix.length):path,Tabbar=class{constructor(hostRef){Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.g)(this,hostRef),this.onLongPress=Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"longpress",7),this.homePage="",this.customRoutes=[],this.tabbarPos="bottom",this.selectedIndex=-1,this.status=0,this.getOriginUrl=url=>{const customRoute=this.customRoutes.filter(([,customUrl])=>splitUrl(customUrl).path===splitUrl(url).path);return customRoute.length?customRoute[0][0]:url},this.getSelectedIndex=url=>{let foundIndex=-1;return this.list.forEach(({pagePath:pagePath},idx)=>{splitUrl(url).path===splitUrl(pagePath).path&&(foundIndex=idx)}),foundIndex},this.switchTab=index=>{this.selectedIndex=index,Taro.navigateTo({url:this.list[index].pagePath})},this.switchTabHandler=({url:url,successHandler:successHandler,errorHandler:errorHandler})=>{const nextTab=function resolvePathname(to,from){void 0===from&&(from="");var hasTrailingSlash,toParts=to&&to.split("/")||[],fromParts=from&&from.split("/")||[],isToAbs=to&&isAbsolute(to),isFromAbs=from&&isAbsolute(from),mustEndAbs=isToAbs||isFromAbs;if(to&&isAbsolute(to)?fromParts=toParts:toParts.length&&(fromParts.pop(),fromParts=fromParts.concat(toParts)),!fromParts.length)return"/";if(fromParts.length){var last=fromParts[fromParts.length-1];hasTrailingSlash="."===last||".."===last||""===last}else hasTrailingSlash=!1;for(var up=0,i=fromParts.length;i>=0;i--){var part=fromParts[i];"."===part?spliceOne(fromParts,i):".."===part?(spliceOne(fromParts,i),up++):up&&(spliceOne(fromParts,i),up--)}if(!mustEndAbs)for(;up--;up)fromParts.unshift("..");!mustEndAbs||""===fromParts[0]||fromParts[0]&&isAbsolute(fromParts[0])||fromParts.unshift("");var result=fromParts.join("/");return hasTrailingSlash&&"/"!==result.substr(-1)&&(result+="/"),result}(url,this.getOriginUrl(this.getCurrentUrl()||this.homePage)),foundIndex=this.getSelectedIndex(nextTab);foundIndex>-1?(this.switchTab(foundIndex),successHandler({errMsg:"switchTab:ok"})):errorHandler({errMsg:`switchTab:fail page "${nextTab}" is not found`})},this.routerChangeHandler=options=>{let toLocation,currentPage;if(options&&(toLocation=options.toLocation),toLocation&&toLocation.path){const tmpPath=addLeadingSlash(toLocation.path);currentPage="/"===tmpPath?this.homePage:tmpPath}else currentPage=this.getCurrentUrl();this.selectedIndex=this.getSelectedIndex(this.getOriginUrl(currentPage))},this.setTabBarBadgeHandler=({index:index,text:text,errorHandler:errorHandler})=>{index in this.list?(this.list[index].showRedDot=!1,this.list[index].badgeText=text):errorHandler({errMsg:"setTabBarBadge:fail tabbar item not found"})},this.removeTabBarBadgeHandler=({index:index,successHandler:successHandler,errorHandler:errorHandler})=>{index in this.list?(this.list[index].badgeText=null,this.list[index].badgeText=null,successHandler({errMsg:"removeTabBarBadge:ok"})):errorHandler({errMsg:"removeTabBarBadge:fail tabbar item not found"})},this.showTabBarRedDotHandler=({index:index,successHandler:successHandler,errorHandler:errorHandler})=>{const list=this.list;index in list?(list[index].badgeText=null,list[index].showRedDot=!0,successHandler({errMsg:"showTabBarRedDot:ok"})):errorHandler({errMsg:"showTabBarRedDot:fail tabbar item not found"})},this.hideTabBarRedDotHandler=({index:index,successHandler:successHandler,errorHandler:errorHandler})=>{const list=this.list;index in list?(list[index].showRedDot=!1,successHandler({errMsg:"hideTabBarRedDot:ok"})):errorHandler({errMsg:"hideTabBarRedDot:fail tabbar item not found"})},this.showTabBarHandler=({successHandler:successHandler})=>{this.status=0,successHandler({errMsg:"showTabBar:ok"})},this.hideTabBarHandler=({animation:animation,successHandler:successHandler})=>{this.status=animation?2:1,successHandler({errMsg:"hideTabBar:ok"})};const list=this.conf.list,customRoutes=this.conf.customRoutes;if("[object Array]"!==Object.prototype.toString.call(list)||list.length<2||list.length>5)throw new Error("tabBar 配置错误");this.homePage=addLeadingSlash(this.conf.homePage);for(const key in customRoutes)this.customRoutes.push([key,customRoutes[key]]);list.forEach(item=>{0!==item.pagePath.indexOf("/")&&(item.pagePath="/"+item.pagePath)}),this.list=list}getCurrentUrl(){const routerMode=this.conf.mode,routerBasename=this.conf.basename||"/";let url;if("hash"===routerMode){const href=window.location.href,hashIndex=href.indexOf("#");url=-1===hashIndex?"":href.substring(hashIndex+1)}else url=location.pathname;const processedUrl=addLeadingSlash(stripBasename(url,routerBasename));return"/"===processedUrl?this.homePage:processedUrl}bindEvent(){Taro.eventCenter.on("__taroRouterChange",this.routerChangeHandler),Taro.eventCenter.on("__taroSwitchTab",this.switchTabHandler),Taro.eventCenter.on("__taroSetTabBarBadge",this.setTabBarBadgeHandler),Taro.eventCenter.on("__taroRemoveTabBarBadge",this.removeTabBarBadgeHandler),Taro.eventCenter.on("__taroShowTabBarRedDotHandler",this.showTabBarRedDotHandler),Taro.eventCenter.on("__taroHideTabBarRedDotHandler",this.hideTabBarRedDotHandler),Taro.eventCenter.on("__taroShowTabBar",this.showTabBarHandler),Taro.eventCenter.on("__taroHideTabBar",this.hideTabBarHandler)}removeEvent(){Taro.eventCenter.off("__taroRouterChange",this.routerChangeHandler),Taro.eventCenter.off("__taroSwitchTab",this.switchTabHandler),Taro.eventCenter.off("__taroSetTabBarBadge",this.setTabBarBadgeHandler),Taro.eventCenter.off("__taroRemoveTabBarBadge",this.removeTabBarBadgeHandler),Taro.eventCenter.off("__taroShowTabBarRedDotHandler",this.showTabBarRedDotHandler),Taro.eventCenter.off("__taroHideTabBarRedDotHandler",this.hideTabBarRedDotHandler),Taro.eventCenter.off("__taroShowTabBar",this.showTabBarHandler),Taro.eventCenter.off("__taroHideTabBar",this.hideTabBarHandler)}componentDidLoad(){this.tabbarPos=this.tabbar.nextElementSibling?"top":"bottom",this.bindEvent(),this.routerChangeHandler()}disconnectedCallback(){this.removeEvent()}render(){const{conf:conf,tabbarPos:tabbarPos="bottom"}=this,status=this.status,containerCls=Object(_index_ff1b322a_js__WEBPACK_IMPORTED_MODULE_1__.a)("weui-tabbar",{["taro-tabbar__border-"+(conf.borderStyle||"black")]:!0}),shouldHideTabBar=-1===this.selectedIndex||1===status,shouldSlideout=2===status;return Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.a,{class:Object(_index_ff1b322a_js__WEBPACK_IMPORTED_MODULE_1__.a)("taro-tabbar__tabbar","taro-tabbar__tabbar-"+tabbarPos,{"taro-tabbar__tabbar-hide":shouldHideTabBar,"taro-tabbar__tabbar-slideout":shouldSlideout})},Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("div",{class:containerCls,style:{backgroundColor:conf.backgroundColor||""}},this.list.map((item,index)=>{const isSelected=this.selectedIndex===index;let textColor,iconPath;return isSelected?(textColor=conf.selectedColor,iconPath=item.selectedIconPath):(textColor=conf.color||"",iconPath=item.iconPath),Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)(TabbarItem,{index:index,onSelect:this.switchTab.bind(this),isSelected:isSelected,textColor:textColor,iconPath:iconPath,text:item.text,badgeText:item.badgeText,showRedDot:item.showRedDot})})))}get tabbar(){return Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.d)(this)}};Tabbar.style="html,body{height:100%}#app{height:100%}.taro-tabbar__border-white::before{border-top-color:#fff !important}.taro-tabbar__container{display:flex;height:100%;flex-direction:column;overflow:hidden}.taro-tabbar__panel{flex:1;position:relative;overflow:auto;-webkit-overflow-scrolling:touch}.taro-tabbar__tabbar{position:relative;height:50px;width:100%;transition:bottom 0.2s, top 0.2s}.taro-tabbar__tabbar-top{top:0}.taro-tabbar__tabbar-bottom{bottom:0}.taro-tabbar__tabbar-hide{display:none}.taro-tabbar__tabbar-slideout{top:-52px;flex:0 0}.taro-tabbar__panel+.taro-tabbar__tabbar-slideout{top:auto;bottom:-52px}"},1530:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return classnames}));var classnames=function createCommonjsModule(fn,basedir,module){return fn(module={path:basedir,exports:{},require:function(path,base){return function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},module.exports),module.exports}((function(module){!function(){var hasOwn={}.hasOwnProperty;function classNames(){for(var classes=[],i=0;i<arguments.length;i++){var arg=arguments[i];if(arg){var argType=typeof arg;if("string"===argType||"number"===argType)classes.push(arg);else if(Array.isArray(arg)){if(arg.length){var inner=classNames.apply(null,arg);inner&&classes.push(inner)}}else if("object"===argType)if(arg.toString===Object.prototype.toString)for(var key in arg)hasOwn.call(arg,key)&&arg[key]&&classes.push(key);else classes.push(arg.toString())}}return classes.join(" ")}module.exports?(classNames.default=classNames,module.exports=classNames):window.classNames=classNames}()}))}}]);
//# sourceMappingURL=13.15fb6d0535874d97d7d4.bundle.js.map