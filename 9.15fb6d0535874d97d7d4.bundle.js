/*! For license information please see 9.15fb6d0535874d97d7d4.bundle.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1511:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"taro_picker_core",(function(){return Picker})),__webpack_require__.d(__webpack_exports__,"taro_picker_group",(function(){return TaroPickerGroup}));var _index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(225),_index_ff1b322a_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1530);function getTimeRange(begin,end){const range=[];for(let i=begin;i<=end;i++)range.push(`${i<10?"0":""}${i}`);return range}const hoursRange=["20","21","22","23",...getTimeRange(0,23),"00","01","02","03"],minutesRange=["56","57","58","59",...getTimeRange(0,59),"00","01","02","03"];function verifyValue(value,range){return!isNaN(+value)&&value>=0&&value<range.length}function verifyTime(value){if(!/^\d{1,2}:\d{1,2}$/.test(value))return!1;const time=value.split(":").map(num=>+num);return!(time[0]<0||time[0]>23)&&!(time[1]<0||time[1]>59)}function compareTime(t1,t2){const t1List=t1.split(":").map(i=>+i),t2List=t2.split(":").map(i=>+i);return t1List[0]<t2List[0]||t1List[0]===t2List[0]&&t1List[1]<=t2List[1]}function verifyDate(dateStr){if(!dateStr)return!1;const date=new Date(dateStr.replace(/-/g,"/"));return!isNaN(date.getMonth())&&date}function formatValue(value){let res;return res=Array.isArray(value)?value.map(item=>String(item)):value,res}function getDateRange(start,end){const range=[];for(let i=start;i<=end;i++)range.push(i);return range}function getYearRange(start,end){return getDateRange(start,end)}function getMonthRange(start,end,year){let rangeStart=1,rangeEnd=12;return start.getFullYear()===year&&(rangeStart=start.getMonth()+1),end.getFullYear()===year&&(rangeEnd=end.getMonth()+1),getDateRange(rangeStart,rangeEnd)}function getDayRange(start,end,year,month){let rangeStart=1,rangeEnd=function getMaxDay(year,month){return 4===month||6===month||9===month||11===month?30:2===month?year%4==0&&year%100!=0||year%400==0?29:28:31}(year,month);return start.getFullYear()===year&&start.getMonth()+1===month&&(rangeStart=start.getDate()),end.getFullYear()===year&&end.getMonth()+1===month&&(rangeEnd=end.getDate()),getDateRange(rangeStart,rangeEnd)}const Picker=class{constructor(hostRef){Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.g)(this,hostRef),this.onChange=Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"change",7),this.onColumnChange=Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"columnchange",7),this.onCancel=Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"cancel",7),this.index=[],this.mode="selector",this.disabled=!1,this.range=[],this.start="",this.end="",this.fields="day",this.name="",this.pickerValue=[],this.height=[],this.hidden=!0,this.fadeOut=!1,this.isWillLoadCalled=!1,this.showPicker=()=>{this.disabled||(this.height=this.getHeightByIndex(),this.hidden=!1)},this.getHeightByIndex=()=>this.index.map(i=>{let factor=0;return"time"===this.mode&&(factor=136),102-34*i-factor}),this.hidePicker=()=>{this.fadeOut=!0,setTimeout(()=>{this.hidden=!0,this.fadeOut=!1},350)},this.handleChange=()=>{this.hidePicker(),this.index=this.height.map(h=>(102-h)/34);let value=this.index.length&&"selector"!==this.mode?this.index:this.index[0];if("time"===this.mode){const range=[hoursRange.slice(),minutesRange.slice()],timeArr=this.index.map((n,i)=>range[i][n]);this.index=timeArr.map(item=>parseInt(item)),value=timeArr.join(":")}if("date"===this.mode){const{_start:_start,_end:_end,_updateValue:_updateValue}=this.pickerDate,currentYear=_updateValue[0],currentMonth=_updateValue[1],yearRange=getYearRange(_start.getFullYear(),_end.getFullYear()),monthRange=getMonthRange(_start,_end,currentYear),dayRange=getDayRange(_start,_end,currentYear,currentMonth),year=yearRange[this.index[0]],month=monthRange[this.index[1]],day=dayRange[this.index[2]];value="year"===this.fields?[year]:"month"===this.fields?[year,month]:[year,month,day],value=value.map(item=>item<10?"0"+item:item).join("-")}this.pickerValue=value,this.onChange.emit({value:value})},this.handleCancel=()=>{this.hidePicker(),this.onCancel.emit()},this.updateHeight=(height,columnId,needRevise=!1)=>{const temp=[...this.height];if(temp[columnId]=height,this.height=temp,needRevise){let{start:start,end:end}=this;if(verifyTime(start)||(start="00:00"),verifyTime(end)||(end="23:59"),!compareTime(start,end))return;const range=[hoursRange.slice(),minutesRange.slice()],timeStr=this.height.map(h=>(102-h)/34).map((n,i)=>range[i][n]).join(":");if(compareTime(start,timeStr)){if(!compareTime(timeStr,end)){const height=end.split(":").map(i=>102-34*(+i+4));requestAnimationFrame(()=>this.height=height)}}else{const height=start.split(":").map(i=>102-34*(+i+4));requestAnimationFrame(()=>this.height=height)}}},this.handleColumnChange=(height,columnId)=>{this.onColumnChange.emit({column:Number(columnId),value:(102-height)/34})},this.updateDay=(value,fields)=>{const{_start:_start,_end:_end,_updateValue:_updateValue}=this.pickerDate;_updateValue[fields]=value;const currentYear=_updateValue[0],currentMonth=_updateValue[1],currentDay=_updateValue[2];if(0===fields){const monthRange=getMonthRange(_start,_end,currentYear),max=monthRange[monthRange.length-1],min=monthRange[0];currentMonth>max&&(_updateValue[1]=max),currentMonth<min&&(_updateValue[1]=min);const height=102-34*monthRange.indexOf(_updateValue[1]);this.updateDay(_updateValue[1],1),this.updateHeight(height,"1")}else if(1===fields){const dayRange=getDayRange(_start,_end,currentYear,currentMonth),max=dayRange[dayRange.length-1],min=dayRange[0];currentDay>max&&(_updateValue[2]=max),currentDay<min&&(_updateValue[2]=min);const height=102-34*dayRange.indexOf(_updateValue[2]);this.updateDay(_updateValue[2],2),this.updateHeight(height,"2")}},this.getSelector=()=>Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("taro-picker-group",{range:this.range,rangeKey:this.rangeKey,height:this.height[0],updateHeight:this.updateHeight,columnId:"0"}),this.getMultiSelector=()=>this.range.map((range,index)=>Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("taro-picker-group",{range:range,rangeKey:this.rangeKey,height:this.height[index],updateHeight:this.updateHeight,onColumnChange:this.handleColumnChange,columnId:String(index)})),this.getTimeSelector=()=>{const hourRange=hoursRange.slice(),minRange=minutesRange.slice();return[Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("taro-picker-group",{mode:"time",range:hourRange,height:this.height[0],updateHeight:this.updateHeight,columnId:"0"}),Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("taro-picker-group",{mode:"time",range:minRange,height:this.height[1],updateHeight:this.updateHeight,columnId:"1"})]},this.getDateSelector=()=>{const{fields:fields,height:height}=this,{_start:_start,_end:_end,_updateValue:_updateValue}=this.pickerDate,currentYear=_updateValue[0],currentMonth=_updateValue[1],yearRange=getYearRange(_start.getFullYear(),_end.getFullYear()).map(item=>item+"年"),monthRange=getMonthRange(_start,_end,currentYear).map(item=>(item<10?"0"+item:item)+"月"),dayRange=getDayRange(_start,_end,currentYear,currentMonth).map(item=>(item<10?"0"+item:item)+"日"),renderView=[Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("taro-picker-group",{mode:"date",range:yearRange,height:height[0],updateDay:this.updateDay,updateHeight:this.updateHeight,columnId:"0"})];return"month"!==fields&&"day"!==fields||renderView.push(Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("taro-picker-group",{mode:"date",range:monthRange,height:height[1],updateDay:this.updateDay,updateHeight:this.updateHeight,columnId:"1"})),"day"===fields&&renderView.push(Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("taro-picker-group",{mode:"date",range:dayRange,height:height[2],updateDay:this.updateDay,updateHeight:this.updateHeight,columnId:"2"})),renderView}}componentWillLoad(){this.isWillLoadCalled=!0,this.handleProps()}componentDidLoad(){Object.defineProperty(this.el,"value",{get:()=>this.pickerValue,set:val=>this.value=val,configurable:!0}),this.overlay&&document.body.appendChild(this.overlay)}disconnectedCallback(){var _a;this.overlay&&(null===(_a=this.overlay.parentNode)||void 0===_a||_a.removeChild(this.overlay))}onPropsChange(){this.isWillLoadCalled&&this.handleProps()}handleProps(){const{mode:mode,start:start,end:end}=this;if("selector"===mode){const value=this.value;this.index=[verifyValue(value,this.range)?Math.floor(value):0]}else if("multiSelector"===mode){const value=this.value;this.index=[],this.range.forEach((range,index)=>{const val=null==value?void 0:value[index],item=verifyValue(val,range)?Math.floor(val):0;this.index.push(item)})}else if("time"===mode){let value=this.value;verifyTime(value)||(console.warn("time picker value illegal"),value="0:0");const time=value.split(":").map(n=>+n);this.index=time}else if("date"===mode){const _value=verifyDate(this.value)||new Date((new Date).setHours(0,0,0,0)),_start=verifyDate(start)||new Date("1970/01/01"),_end=verifyDate(end)||new Date("2999/01/01");if(!(_value>=_start&&_value<=_end))throw new Error("Date Interval Error");{const currentYear=_value.getFullYear(),currentMonth=_value.getMonth()+1,currentDay=_value.getDate(),yearRange=getYearRange(_start.getFullYear(),_end.getFullYear()),monthRange=getMonthRange(_start,_end,currentYear),dayRange=getDayRange(_start,_end,currentYear,currentMonth);this.index=[yearRange.indexOf(currentYear),monthRange.indexOf(currentMonth),dayRange.indexOf(currentDay)],this.pickerDate&&this.pickerDate._value.getTime()===_value.getTime()&&this.pickerDate._start.getTime()===_start.getTime()&&this.pickerDate._end.getTime()===_end.getTime()||(this.pickerDate={_value:_value,_start:_start,_end:_end,_updateValue:[currentYear,currentMonth,currentDay]})}}if(this.height=this.getHeightByIndex(),this.pickerValue=this.value,"date"===mode){const val=this.pickerValue;"month"===this.fields?this.pickerValue=val.split("-").slice(0,2).join("-"):"year"===this.fields&&(this.pickerValue=val.split("-")[0])}}render(){const{name:name,mode:mode,fadeOut:fadeOut,hidden:hidden}=this;let pickerGroup;switch(mode){case"multiSelector":pickerGroup=this.getMultiSelector();break;case"time":pickerGroup=this.getTimeSelector();break;case"date":pickerGroup=this.getDateSelector();break;default:pickerGroup=this.getSelector()}const clsMask=Object(_index_ff1b322a_js__WEBPACK_IMPORTED_MODULE_1__.a)("weui-mask","weui-animate-fade-in",{"weui-animate-fade-out":fadeOut}),clsSlider=Object(_index_ff1b322a_js__WEBPACK_IMPORTED_MODULE_1__.a)("weui-picker","weui-animate-slide-up",{"weui-animate-slide-down":fadeOut}),shouldDivHidden=hidden?{display:"none"}:{};return Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.a,null,Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("div",{onClick:this.showPicker},Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("slot",null),Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("input",{type:"hidden",name:name,value:formatValue(this.pickerValue)})),Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("div",{class:"weui-picker__overlay",style:shouldDivHidden,ref:el=>{this.overlay=el}},Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("div",{class:clsMask,onClick:this.handleCancel}),Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("div",{class:clsSlider},Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("div",{class:"weui-picker__hd"},Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("div",{class:"weui-picker__action",onClick:this.handleCancel},"取消"),Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("div",{class:"weui-picker__action",onClick:this.handleChange},"确定")),Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("div",{class:"weui-picker__bd"},pickerGroup),Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("input",{type:"hidden",name:name,value:formatValue(this.pickerValue)}))))}get el(){return Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.d)(this)}static get watchers(){return{mode:["onPropsChange"],value:["onPropsChange"],range:["onPropsChange"],start:["onPropsChange"],end:["onPropsChange"]}}};Picker.style=".weui-picker,.weui-picker__hd{font-size:12px}";const TaroPickerGroup=class{constructor(hostRef){Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.g)(this,hostRef),this.range=[]}getPosition(){const transition=this.touchEnd?.3:0,transformValue=`translate3d(0, ${this.height}px, 0)`,transitionValue=`transform ${transition}s`;return{transform:transformValue,"-webkit-transform":transformValue,transition:transitionValue,"-webkit-transition":transitionValue}}formulaUnlimitedScroll(range,absoluteHeight,direction){const{height:height,updateHeight:updateHeight,columnId:columnId}=this,factor="up"===direction?1:-1;this.touchEnd=!1,updateHeight(-range*factor*34+height,columnId),requestAnimationFrame(()=>{this.touchEnd=!0;const index=Math.round(absoluteHeight/-34)+range*factor;updateHeight(102-34*index,columnId,!0)})}onTouchStart(e){this.startY=e.changedTouches[0].clientY,this.preY=e.changedTouches[0].clientY,this.hadMove=!1}onTouchMove(e){e.preventDefault();const y=e.changedTouches[0].clientY,deltaY=y-this.preY;this.preY=y,this.touchEnd=!1,Math.abs(y-this.startY)>10&&(this.hadMove=!0);let newPos=this.height+deltaY;"time"===this.mode&&("0"===this.columnId?(newPos>0&&(newPos=-816+deltaY),newPos<-850&&(newPos=-34+deltaY)):"1"===this.columnId&&(newPos>0&&(newPos=-2040+deltaY),newPos<-2074&&(newPos=-34+deltaY))),this.updateHeight(newPos,this.columnId)}onTouchEnd(e){const{mode:mode,range:range,height:height,updateHeight:updateHeight,onColumnChange:onColumnChange,columnId:columnId}=this,min=-34*(range.length-1),endY=e.changedTouches[0].clientY;let absoluteHeight;if(this.touchEnd=!0,this.hadMove)absoluteHeight=height-102;else{if(absoluteHeight=height-102-(endY-(window.innerHeight-119)),"time"===mode)if("0"===columnId){if(absoluteHeight>-85)return this.formulaUnlimitedScroll(24,absoluteHeight,"up");if(absoluteHeight<-969)return this.formulaUnlimitedScroll(24,absoluteHeight,"down")}else if("1"===columnId){if(absoluteHeight>-85)return this.formulaUnlimitedScroll(60,absoluteHeight,"up");if(absoluteHeight<-2193)return this.formulaUnlimitedScroll(60,absoluteHeight,"down")}}absoluteHeight>0&&(absoluteHeight=0),absoluteHeight<min&&(absoluteHeight=min);const index=Math.round(absoluteHeight/-34),relativeHeight=102-34*index;"date"===this.mode&&("0"===this.columnId&&this.updateDay(+this.range[index].replace(/[^0-9]/gi,""),0),"1"===this.columnId&&this.updateDay(+this.range[index].replace(/[^0-9]/gi,""),1),"2"===this.columnId&&this.updateDay(+this.range[index].replace(/[^0-9]/gi,""),2)),updateHeight(relativeHeight,columnId,"time"===mode),onColumnChange&&onColumnChange(relativeHeight,columnId)}render(){const{range:range,rangeKey:rangeKey}=this,pickerItem=range.map(item=>{const content=rangeKey?item[rangeKey]:item;return Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("div",{class:"weui-picker__item"},content)});return Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.a,{class:"weui-picker__group"},Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("div",{class:"weui-picker__mask"}),Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("div",{class:"weui-picker__indicator"}),Object(_index_310de3d5_js__WEBPACK_IMPORTED_MODULE_0__.e)("div",{class:"weui-picker__content",style:this.getPosition()},pickerItem))}}},1530:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return classnames}));var classnames=function createCommonjsModule(fn,basedir,module){return fn(module={path:basedir,exports:{},require:function(path,base){return function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},module.exports),module.exports}((function(module){!function(){var hasOwn={}.hasOwnProperty;function classNames(){for(var classes=[],i=0;i<arguments.length;i++){var arg=arguments[i];if(arg){var argType=typeof arg;if("string"===argType||"number"===argType)classes.push(arg);else if(Array.isArray(arg)){if(arg.length){var inner=classNames.apply(null,arg);inner&&classes.push(inner)}}else if("object"===argType)if(arg.toString===Object.prototype.toString)for(var key in arg)hasOwn.call(arg,key)&&arg[key]&&classes.push(key);else classes.push(arg.toString())}}return classes.join(" ")}module.exports?(classNames.default=classNames,module.exports=classNames):window.classNames=classNames}()}))}}]);
//# sourceMappingURL=9.15fb6d0535874d97d7d4.bundle.js.map